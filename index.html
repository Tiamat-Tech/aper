<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Aper</title>
        <link rel="stylesheet" href="style.css" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <link rel="icon" type="image/png" href="favicon.png">
    </head>
    <body>
    <div id="main">
      <div style="background: #ffffba;
    margin-bottom: 30px;
    padding: 15px;
    line-height: 121%;
    border: 1px dashed black;">
<strong>Aper is very early stage.</strong> Feel free to poke around but please be aware that examples may not be in sync with the repo or crates versions of Aper.
</div>
<div id="header">
    <div id="text">Aper is like Git for your data structures.</div>
    <div id="image">
        <img src="ape.svg" style="width: 180px; height: 180px;" />
    </div>
</div>
<p class="explanation">Aper is an <a href="https://github.com/aper-dev/aper/blob/main/LICENSE">MIT-licensed</a> Rust library.</p>
<div class="buttons">
<a class="button primary" href="/guide/">Getting Started Guide</a>
<a class="button" href="https://github.com/aper-dev/aper">
<svg style="display: inline; width: 13px; fill: white;" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub icon</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
GitHub</a>
<a class="button" href="/doc/aper/">
<svg xmlns="http://www.w3.org/2000/svg" style="display: inline; width: 13px; fill: white;" viewBox="0 0 512 512"><path d="M488.6 250.2L392 214V105.5c0-15-9.3-28.4-23.4-33.7l-100-37.5c-8.1-3.1-17.1-3.1-25.3 0l-100 37.5c-14.1 5.3-23.4 18.7-23.4 33.7V214l-96.6 36.2C9.3 255.5 0 268.9 0 283.9V394c0 13.6 7.7 26.1 19.9 32.2l100 50c10.1 5.1 22.1 5.1 32.2 0l103.9-52 103.9 52c10.1 5.1 22.1 5.1 32.2 0l100-50c12.2-6.1 19.9-18.6 19.9-32.2V283.9c0-15-9.3-28.4-23.4-33.7zM358 214.8l-85 31.9v-68.2l85-37v73.3zM154 104.1l102-38.2 102 38.2v.6l-102 41.4-102-41.4v-.6zm84 291.1l-85 42.5v-79.1l85-38.8v75.4zm0-112l-102 41.4-102-41.4v-.6l102-38.2 102 38.2v.6zm240 112l-85 42.5v-79.1l85-38.8v75.4zm0-112l-102 41.4-102-41.4v-.6l102-38.2 102 38.2v.6z"></path></svg>
docs</a>
<a class="button" href="https://crates.io/crates/aper">crates.io</a>
</div>
<div class="code-caption">
    <p>Every data mutation is a <strong>first-class value</strong>.</p>
    <p>Serialize them to synchronize state across a network, or to create an audit log.</p>
</div>
<pre style="background-color:#eff1f5;">
<span style="color:#b48ead;">use </span><span style="color:#4f5b66;">aper::{List, Atom};
</span><span style="color:#a7adba;">// `List` represents an ordered list.
</span><span style="color:#a7adba;">// `Atom` wraps a value to make it immutable
</span><span style="color:#a7adba;">// except by replacement.
</span><span style="color:#4f5b66;">
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">main</span><span style="color:#4f5b66;">() {
</span><span style="color:#4f5b66;">    </span><span style="color:#b48ead;">let mut</span><span style="color:#4f5b66;"> my_list: List&lt;Atom&lt;String&gt;&gt; = List::new();
</span><span style="color:#4f5b66;">    
</span><span style="color:#4f5b66;">    </span><span style="color:#b48ead;">let </span><span style="color:#4f5b66;">(_id, transition) = my_list.</span><span style="color:#96b5b4;">push</span><span style="color:#4f5b66;">(Atom::new(
</span><span style="color:#4f5b66;">        &quot;</span><span style="color:#a3be8c;">Hello Aper</span><span style="color:#4f5b66;">&quot;.</span><span style="color:#96b5b4;">to_string</span><span style="color:#4f5b66;">()));
</span><span style="color:#4f5b66;">
</span><span style="color:#4f5b66;">    </span><span style="color:#a7adba;">// `transition` represents the action of adding
</span><span style="color:#4f5b66;">    </span><span style="color:#a7adba;">// &quot;Hello Aper&quot; to the list, but doesnâ€™t actually
</span><span style="color:#4f5b66;">    </span><span style="color:#a7adba;">// modify the data.
</span><span style="color:#4f5b66;">
</span><span style="color:#4f5b66;">    my_list.</span><span style="color:#96b5b4;">apply</span><span style="color:#4f5b66;">(transition);
</span><span style="color:#4f5b66;">
</span><span style="color:#4f5b66;">    </span><span style="color:#a7adba;">// Now the transition is applied.
</span><span style="color:#4f5b66;">}
</span></pre><br clear="both" />
<div class="code-caption">
    <p>Mutations can be applied <strong>out-of-order</strong>.</p>
    <p>Mutations encode intent, so concurrent mutations are cleanly applied where possible.</p>
</div>
<pre style="background-color:#eff1f5;">
<span style="color:#b48ead;">use </span><span style="color:#4f5b66;">aper::{List, Atom};
</span><span style="color:#4f5b66;">
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">main</span><span style="color:#4f5b66;">() {
</span><span style="color:#4f5b66;">    </span><span style="color:#b48ead;">let mut</span><span style="color:#4f5b66;"> my_list: List&lt;Atom&lt;</span><span style="color:#b48ead;">u32</span><span style="color:#4f5b66;">&gt;&gt; = List::new();
</span><span style="color:#4f5b66;">    
</span><span style="color:#4f5b66;">    </span><span style="color:#b48ead;">let </span><span style="color:#4f5b66;">(id1, transition1) = my_list.</span><span style="color:#96b5b4;">push</span><span style="color:#4f5b66;">(Atom::new(</span><span style="color:#d08770;">1</span><span style="color:#4f5b66;">));
</span><span style="color:#4f5b66;">    </span><span style="color:#b48ead;">let </span><span style="color:#4f5b66;">(id2, transition2) = my_list.</span><span style="color:#96b5b4;">push</span><span style="color:#4f5b66;">(Atom::new(</span><span style="color:#d08770;">2</span><span style="color:#4f5b66;">));
</span><span style="color:#4f5b66;">
</span><span style="color:#4f5b66;">    my_list.</span><span style="color:#96b5b4;">apply</span><span style="color:#4f5b66;">(transition2); </span><span style="color:#a7adba;">// my_list = [2]
</span><span style="color:#4f5b66;">    my_list.</span><span style="color:#96b5b4;">apply</span><span style="color:#4f5b66;">(transition1); </span><span style="color:#a7adba;">// my_list = [2, 1]
</span><span style="color:#4f5b66;">
</span><span style="color:#4f5b66;">    </span><span style="color:#b48ead;">let </span><span style="color:#4f5b66;">(_id3, transition3) = my_list
</span><span style="color:#4f5b66;">        .</span><span style="color:#96b5b4;">insert_between</span><span style="color:#4f5b66;">(id2, id1, Atom::new(</span><span style="color:#d08770;">3</span><span style="color:#4f5b66;">));
</span><span style="color:#4f5b66;">
</span><span style="color:#4f5b66;">    </span><span style="color:#b48ead;">let </span><span style="color:#4f5b66;">(_id4, transition4) = my_list
</span><span style="color:#4f5b66;">        .</span><span style="color:#96b5b4;">insert_between</span><span style="color:#4f5b66;">(id2, id1, Atom::new(</span><span style="color:#d08770;">4</span><span style="color:#4f5b66;">));
</span><span style="color:#4f5b66;">
</span><span style="color:#4f5b66;">    my_list.</span><span style="color:#96b5b4;">apply</span><span style="color:#4f5b66;">(transition4); </span><span style="color:#a7adba;">// my_list = [2, 4, 1]
</span><span style="color:#4f5b66;">    my_list.</span><span style="color:#96b5b4;">apply</span><span style="color:#4f5b66;">(transition3); </span><span style="color:#a7adba;">// my_list = [2, 4, 3, 1]
</span><span style="color:#4f5b66;">}
</span></pre><br clear="both" />
<div class="code-caption">
    <p>Implement arbitrary <strong>update logic</strong>.</p>
    <p>Define your own units of state that integrate seamlessly with Aper's built-in data structures.</p>
</div>
<pre style="background-color:#eff1f5;">
<span style="color:#b48ead;">use </span><span style="color:#4f5b66;">aper::{StateMachine, Transition};
</span><span style="color:#b48ead;">use </span><span style="color:#4f5b66;">serde::{Serialize, Deserialize};
</span><span style="color:#4f5b66;">
</span><span style="color:#4f5b66;">#[</span><span style="color:#bf616a;">derive</span><span style="color:#4f5b66;">(Serialize, Deserialize, Debug, Clone)]
</span><span style="color:#b48ead;">struct </span><span style="color:#4f5b66;">Counter {</span><span style="color:#bf616a;">value</span><span style="color:#4f5b66;">: </span><span style="color:#b48ead;">i64</span><span style="color:#4f5b66;">}
</span><span style="color:#4f5b66;">
</span><span style="color:#4f5b66;">#[</span><span style="color:#bf616a;">derive</span><span style="color:#4f5b66;">(Transition, Serialize, Deserialize,
</span><span style="color:#4f5b66;">    Debug, Clone, PartialEq)]
</span><span style="color:#b48ead;">enum </span><span style="color:#4f5b66;">CounterTransition {
</span><span style="color:#4f5b66;">   Add(</span><span style="color:#b48ead;">i64</span><span style="color:#4f5b66;">),
</span><span style="color:#4f5b66;">   Subtract(</span><span style="color:#b48ead;">i64</span><span style="color:#4f5b66;">),
</span><span style="color:#4f5b66;">   Reset,
</span><span style="color:#4f5b66;">}
</span><span style="color:#4f5b66;">
</span><span style="color:#b48ead;">impl </span><span style="color:#4f5b66;">StateMachine </span><span style="color:#b48ead;">for </span><span style="color:#4f5b66;">Counter {
</span><span style="color:#4f5b66;">    </span><span style="color:#b48ead;">type </span><span style="color:#4f5b66;">Transition = CounterTransition;
</span><span style="color:#4f5b66;">
</span><span style="color:#4f5b66;">    </span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">apply</span><span style="color:#4f5b66;">(&amp;</span><span style="color:#b48ead;">mut </span><span style="color:#bf616a;">self</span><span style="color:#4f5b66;">, </span><span style="color:#bf616a;">event</span><span style="color:#4f5b66;">: CounterTransition) {
</span><span style="color:#4f5b66;">        </span><span style="color:#b48ead;">match</span><span style="color:#4f5b66;"> event {
</span><span style="color:#4f5b66;">            CounterTransition::Add(i) =&gt; {
</span><span style="color:#4f5b66;">                </span><span style="color:#bf616a;">self</span><span style="color:#4f5b66;">.value += i;
</span><span style="color:#4f5b66;">            }
</span><span style="color:#4f5b66;">            CounterTransition::Subtract(i) =&gt; {
</span><span style="color:#4f5b66;">                </span><span style="color:#bf616a;">self</span><span style="color:#4f5b66;">.value -= i;
</span><span style="color:#4f5b66;">            }
</span><span style="color:#4f5b66;">            CounterTransition::Reset =&gt; {
</span><span style="color:#4f5b66;">                </span><span style="color:#bf616a;">self</span><span style="color:#4f5b66;">.value = </span><span style="color:#d08770;">0</span><span style="color:#4f5b66;">;
</span><span style="color:#4f5b66;">            }
</span><span style="color:#4f5b66;">        }
</span><span style="color:#4f5b66;">    }
</span><span style="color:#4f5b66;">}
</span></pre>
    </div>
  </body>
</html>
